---
title: 机械手爪部位触觉感应系统
date: 2023-10-26
links:
  - type: site
tags:
  - Course Project
---

<!--more-->

## 项目背景

（1）任务及背景：
    对关节式机械手的手爪部位设计触觉传感模块，通过触觉传感信号反馈控制手爪关节处的步进电机运动，使手爪能可靠牢固抓取物体又不损伤物体，并可进行接触力的阈值设定和超阈值报警提示。

技术要求：
1、	选择合适的触觉传感器类型及具体型号参数，贴于机械手爪的合适位置，检测手爪与物体间的接触力，进行传感测量；
2、	设计触觉信号的传感接口电路，信号放大、滤波、A/D转换等处理电路，使得信号有足够的信噪比，以及步进电机的驱动电路、声光报警电路、及单片机核心控制器和液晶显示电路等；
3、	要求接触力的警戒阈值可显示，超阈值时进行声光报警；
4、	要求液晶实时显示接触力和手爪关节的位移输出量；
5、	需达到的性能指标：手爪运动控制分辨率0.01mm、测力分辨率50mN、测力量程3N。

非技术因素要求：项目设计时，需考虑经济性、环保性、安全性、行业规定、电磁兼容性等因素。

（2）工具环境：计算机（电路设计、软件设计）、电子电路设计及仿真工具（如：Proteus、filtCAD等）和实验环境。

（3）主要参考文献和资料：
1、触觉传感器的类型和原理，传感器方面的资料；
2、步进电机的原理，电机设计相关资料； 
3、测量与控制电路方面的资料，电子电路设计方面的资料。
4、单片微机应用技术和软件编程技术方面的资料；

（4）着重培养的能力：通过本项目，使学生能够根据课题内容搜集相关资料，重点培养对测量与控制电路综合知识的运用能力，掌握工程设计工作的基本要求，培养锻炼团队合作和管理能力，强化学生的工程设计思维和系统理念。

## 一 项目总体方案
### 1 总体方案框图

机械手爪部位触觉感应系统功能的实现主要分解为三个部分，第一部分是通过电阻信号输出电路，放大电路，偏置电路，低通滤波电路以及 ADC 采集电路形成整体的信号生成转化电路，将压力信号转化到 STM32 内置 ADC 可以采集的电压信号范围，第二部分为 STM32 采集压。力信号进行处理，通过 IO 口和 SPI 总线向外围电路发送控制信号，第三部分驱动电路接受控制信号控制外围 LED、蜂鸣器、步进电机等驱动设备。该项目整体的设计方案图如下图1-1。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text.png)

电路总体结构框架为：传感器电桥调幅电路——低通滤波电路（滤高频噪声）——三运放差分放大电路——带通滤波电路（滤噪声）——相敏检波电路——低通滤波电路（取均值）。
本综合电路中在传感器调制电路差分输出和三运算放大电路差分输入之间加入两个截止频率为2kHz的低通滤波电路，分别进行低通滤波实现对于外界高频干扰（主要来自于电机的高频干扰）的滤除。带通滤波电路采用一个一阶有源低通滤波器和一个一阶有源高通滤波器组成，截止频率分别为2kHz和500Hz。总体是依次将传感器调制电路、低通滤波电路、三运算放大电路、带通滤波电路和开关式全波相敏检波电路组合形成综合电路设计。电路设计图如图1-2所示。

![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-1.png)

### 2 功能总体表现与分析
仿真效果展示
①压力变化时，相敏检波后信号变化如图1-3所示。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-2.png)
图1-3 压力变化时相敏检波后信号变化情况

当我们改变R_1和R_4电阻值时，双边带调幅信号的幅值发生变化，相敏检波后的信号的幅值对应发生变化，同时电压平均值根据其幅值的变化发生变化。由图1-3可见，电压平均值能够跟随相敏检波后的信号的幅值发生变化，但是跟随效果不是很好，反应较慢，实时跟踪效果较差。
②当压力为300g时，输出波形与平均电压如图1-4所示。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-3.png)
图1-4 压力为300g时输出的波形
由图16可知，当压力为300g时，输出平均电压约为1V。此时可以看作机械爪稳定抓取了一个物品，受力保持不变，输出电压稳定在一个数值，从而送入ADC，进行之后的显示和电机驱动等环节。
3 团队成员与分工
李嘉渝——调制后二阶压控低通滤波电路设计，全波精密检流电路设计（废弃），OLED、步进电机、MCU控制电路设计，软件代码实现，Proteus控制模拟仿真；
邵光睿——传感器调制电路、三运放放大电路、相敏检波电路设计，电路联调仿真工作；
单林合——ADC选型，AD转换电路设计；
王健城——传感器选型，带通滤波电路设计；
毕世纪——步进电机选型驱动电路设计；
樊小相——声光报警电路设计。
## 二 项目各部分介绍
### 1  调制电路设计
    传感器输出信号研究：
根据DF9-40系列柔性薄膜压力传感器的压力-电阻曲线图，如图2-1所示。由于我们选取的量程是300g，可见对应最小阻值为5KΩ。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-4.png)
图2-1 DF9-40@500g 压力-电阻曲线图
根据DF9-40的性能指标，如表2-1所示，可以得知当压力为0时，阻值大于10MΩ。
表2-1 DF9-40性能指标
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-5.png)
（2）电路设计：
我们采用通过交流供电实现传感器调制。设计电路如图2-2所示。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-6.png)
图2-2 传感器调制电路仿真设计图
调制效果如图2-3所示。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-7.png)
图2-3 传感器调制电路仿真效果图
设R_1和R_4在没有受到压力时（即没有夹取物品时）的阻值为R_1=R_2=R_3=R_4=10MΩ，电桥平衡；在夹取物品受到压力时，R_1和R_4会受到变化，电桥的输出为
U_o=U/4((∆R_1)/R_1 +(∆R_4)/R_4 )
又因为R_1和R_4分别位于机械手爪的两个力臂上，受到的压力相同，所以我们可以将上式写为
U_o=U/2  (∆R_1)/R_1 
这样就实现了载波信号U与测量信号的相乘，即实现了调制。
我们采用交流1V供电，即U=1V。因为当压力为300g时，对应阻值为5kΩ，相较于10MΩ差四个数量级，所以我们在电桥中R_1和R_4近似为0，来进行仿真。
①当压力为300g时，R_1和R_4近似为0，输出波形如图2-4所示。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-8.png)
图2-4 压力为300g时传感器调制电路仿真效果图
由图2-4可见我们输出波形的幅值为1V。
②当压力为0时，R_1和R_4=10MΩ，输出波形如图2-5所示。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-9.png)
图5 压力为0时传感器调制电路仿真效果图
由图2-5可见我们输出电压为472.154nV，近似为0。
### 2  放大电路设计
（1）运算放大器的选型：本次设计我们选择OP07作为我们运算放大器，OP07是一款低失调电压的运算放大器，它采用晶圆级的修调来消除失调，同时还可以通过外部电路进一步减小失调电压。同时具有很低的偏置电流（只有4nA）以及很高的开环增益（最小200V/mv，106dB）。这些特点使得OP07适合用作高增益的仪表放大器。芯片具有±13V的宽输入电压范围，106dB的共模抑制比(CMRR)以及高输入阻抗等特性，使得放大器在放大信号时具有很高的精度。即使在高闭环增益时，也能保证出色的线性度和精度，失调和增益的时间稳定性以及随温度的变化率等参数十分优秀，满足我们的需求。其内部电路图如图2-6所示，管脚图如图2-7所示，极限参数如表2-2所示。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-10.png)
图2-6 OP07内部简化电路图
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-11.png)
图2-7 OP07管脚图
表2-2 OP07的极限参数
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-12.png)
（2）三运算放大器的设计
由于采用集成的三运算放大器AD623AH总是出现无法仿真的问题，所以我们采用分立的三运算放大器的设计。
设计电路图如图2-8所示。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-13.png)
图2-8 三运算放大器设计图
我们将上端输入电压记为U_i1，输出电压记为U_o1，下端输入电压记为U_i2，输出电压记为U_o2，最后输出电压为U_o。可以前级输出电压的差值为
U_o2-U_o1=(1+(R_17+R_18)/R_20 )(U_i2-U_i1)
后级输出电压U_o为
U_o=R_16/(R_15+R_16 )(1+R_14/R_13 )U_o2-R_14/R_13  U_o1
R_20是增益调节电阻，通过调节其阻值可以实现整个三运算放大器的增益。此电路中我们设置R_17=R_18=25kΩ，然后将R_20调整为50kΩ，所以可得
U_o2-U_o1=2(U_o2-U_o1)
我们同样设置R_13=R_14=R_15=R_16=10MΩ，所以可得
U_o=U_o2-U_o1
于是得
U_o=2(U_o2-U_o1)
即我们将整个电路的电压放大了两倍。
输出电压效果如图2-9所示。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-14.png)
图2-9 三运算放大器输出效果比对图
由图2-9明显可见，输出蓝线的幅值是输入红线的幅值的两倍。
### 3  滤波电路设计
（1）传感器调制后二阶压控源巴特沃斯滤波器的设计
由于调制电路改为了电桥调制，故输出的信号为差分信号，要想在对信号进行差分放大前提高信噪比再进行放大，之前的滤波电路就不再适用了。故此处利用两个二阶低通滤波电路分别对两路差分信号进行滤除高频噪声，具体实现电路如图2-10所示。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-15.png)
图2-10 传感器调制后二阶压控源巴特沃斯滤波器
此时，滤波电路将传感器调制电路与三运放差分放大电路联系起来，使信号被放大前提高了信噪比，有利于得到目标信号。滤波器的截止频率设置在2000Hz，以保证1000Hz调制信号频率处信号基本不被衰减。此处应该保证低频信号增益在滤波过程中不受影响，故不考虑使用切比雪夫滤波器；由于贝塞尔滤波器的下降陡峭程度太小，故会导致滤波效果不好，因此此处采用巴特沃斯滤波器。
对于滤波器的阶数，此处考虑采用二阶滤波电路，考虑到环境高频噪声信号频率可能会变化，故此处采用压控电压源型滤波电路，此电路可通过更改运放的放大倍数来改变滤波器的截止频率，具有较强的灵活性与普适性。
根据压控电压源型滤波电路的传递函数： 
H(s)=(K_f Y_1 Y_2)/((Y_1+Y_2+Y_3+Y_4 ) Y_5+[Y_1+(1-K_f ) Y_3+Y_4]Y_2 )
代入计算可得，
H(s)=(K_f∙59.3k∙1.06M)/((59.3k+1.06M+1/(1×10^(-9) s)+0)  1/(100×10^(-12) s)+[59.3k+(1-K_f )  1/(1×10^(-9) s)+0]1.06M)
求得：
f_0=2000Hz
其传递函数幅频特性曲线如图2-11所示。此处采用AD公司的ADA4062高精密运放，适用于二阶巴特沃斯滤波器设计。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-16.png)
图2-11 二阶低通滤波器的幅频特性曲线
假设传感器调制过程中有一个1Mhz的高频噪声信号，因此电桥输出信号为图2-12左图所示。经过二阶低通滤波器后，经过放大2倍，可以得到输出信号如图2-12右图所示。可以看到，高频噪声信号被完全消除，信噪比得到了非常好的提升。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-17.png)
图2-12 模拟滤除高频信号
（2）带通滤波器的设计
①带通滤波器原理
带通滤波器是一种仅允许特定频率通过，同时对其余频率的信号进行有效抑制的电路。由于它对信号具有选择性，故而被广泛地应用现在电子设计中。比如RLC振荡回路就是一个模拟带通滤波器。带通滤波器是指能通过某一频率范围内的频率分量、但将其他范围的频率分量衰减到极低水平的滤波器，与带阻滤波器的概念相对。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-18.png)
图2-13 模拟滤除高频信号
一个理想的带通滤波器应该有一个完全平坦的通带，在通带内没有放大或者衰减。实际上，并不存在理想的带通滤波器。滤波器并不能够将期望频率范围外的所有频率完全衰减掉，尤其是在所要的通带外还有一个被衰减但是没有被隔离的范围。这通常称为滤波器的滚降现象，并且使用每十倍频的衰减幅度的dB数来表示。
②带通滤波器应用
许多音响装置的频谱分析器均使用此电路作为带通滤波器，以选出各个不同频段的信号，在显示上利用发光二极管点亮的多少来指示出信号幅度的大小。这种有源带通滤波器的中心频率 ，在中心频率fo处的电压增益Ao=B3/2B1，品质因数 ，3dB带宽B=1/(п*R3*C)也可根据设计确定的Q、fo、Ao值，去求出带通滤波器的各元件参数值。R1=Q/(2пfoAoC)，R2=Q/((2Q2-Ao)*2пfoC)，R3=2Q/(2пfoC)。上式中，当fo=1KHz时，C取0.01Uf。此电路亦可用于一般的选频放大。 有源带通滤波器电路。
③带通滤波器的设计要求
设计中运放选择TI产品典型的通用双放LM358，LM358里面包括两个高增益、独立的、内部频率补偿的双运放，适用于电压范围很宽的单电源，而且也适用于双电源工作方式，特点方面具有低输入偏置电流、低输入失调电压和失调电流，它的共模输入电压范围较宽，差模输入电压范围等于电源电压范围，单电源供电电压3-32V，双电源供电±1.5-±16V，单位增益带宽为1MHz，适用于一般的带通滤波器的设计，同时具有低功耗的功能，对于设计阶数相对高一些的带通滤波器的话，可以选用TI的四运放LM324，其性能与LM358大体相同，应用起来节省空间。对于运放的要求此设计不是特别高，只要运放的频率满足低通的截止频率即可，如果精确度要求高的话那么首先运放的供电电压要足够稳定，或者选择精密运放，如TLC274A，否则通用的即可，例如推荐TI的LM224四运放。
巴特沃斯带通滤波器幅频响应在通带中具有最平幅度特性，但是从通带到阻带衰减较慢，如果对于过渡带要求稍高，可以增加阶数来实现，否则改选用切比雪夫滤波电路。
④电路设计
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-19.png)
2-14 带通滤波器的设计图
本仿真采用由一个高通滤波器和一个低通滤波器组合而成。第一个高通滤波器，其中，电容为1.7uf，电阻为1kΩ，按照公式计算出频率约为900Hz，第二个低通滤波器的电阻为1kΩ，电容为1.4uf根据公式，计算频率约为1100Hz，从而实现在第一个滤波器中滤出频率高于900Hz的信号，而在第二个滤波器中滤出低于1100Hz的信号，而此信号就为我们的整个设计提供频率适宜的信号。
⑤仿真结果显示及讨论
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-20.png)
2-15 仿真结果
由此可见，当下降3dB时频率为1.052kHz在我们的设定的900Hz到1100Hz的范围内，故仿真成功
4  相敏检波电路设计
电路设计如图2-10所示。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-21.png)
图2-10 开关式全波相敏检波电路设计图



（1）双边带条幅信号的获取
用一个幅值为5V，频率为10Hz的正弦交流信号模拟放大电路输出的信号，即调制信号，同时用一个幅值为1V，频率为1kHz的正弦交流信号作为载波信号，因为载波信号的频率要至少大于调制信号频率的10倍，所以，我们选择1kHz，然后将两者通过乘法器进行相乘，从而调制得到双边带调幅信号。波形如图2-11所示。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-22.png)
图2-11 双边带调幅信号波形图
（2）参考信号的选取
参考信号我们选择为与载波信号一样的正弦交流信号。电路中V1通过一个电压比较器LM393N，输出方波，当正交流信号的数值为“+”（即大于0），输出方波也为“+”，当交流信号输出为“-”（即小于0），输出方波也为“-”。效果如图2-12所示。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-23.png)
图2-12 参考信号波形图
由图2-12可以观察到，我们的通过电压比较器输出的方波的频率和极性与参考信号相同。
（3）输出信号判断
当V2输出信号为“+”时，电压比较器输出方波也为“+”，U1导通，则放大器U3A正向输入端想当于接地，只有负向输入端会输入双边带调幅信号，此时u_i也为“+”，通过放大器后，输出
u_o  =-  R_2/R_1  u_i
又R_1=R_2=10kΩ，所以得u_o  =- u_i，输出为“-”； 当V2输出信号为“-”时，电压比较器输出方波也为“-”，U1不导通，则放大器U3A正向输入和负向输入端都会输入双边带调幅信号，此时u_i也为“-”，通过放大器后，输出
u_o  =-  R_2/R_1  u_i+（1+R_2/R_1 ）u_i=R_2/R_1  u_i
又R_1=R_2=10kΩ，所以得u_o  = u_i，输出为“-”。
又因为是双边带调幅信号，对于正弦信号当班个周期进行完后，下班个周期的信号的幅值会相反，所以下一个周期输出就全为“+”。随后以此类推，一正一负。
（4）低通滤波
通过低通滤波，取平均值，得到相敏检波后的信号。最终相敏检波取平均值如图2-13所示。
![alt text](https://raw.githubusercontent.com/BlackiePiggy/homepage_picbed/master/homepage_img/alt_text-24.png)
图2-13 相敏检波后的信号波形图
最后我们可以观察到相敏检波的后的信号，与我们分析的一致，半个周期幅值全为“+”，下半个周期就为“-”，最后滤波求平均后的信号与我们前期设计的放大电路输出的信号波形一致。
